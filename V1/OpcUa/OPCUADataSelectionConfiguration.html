<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Data selection configuration </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Data selection configuration ">
    <meta name="generator" content="docfx 2.43.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../V1/index.html" width="46">
                <img id="logo" src="../../V1/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="OPCUADataSelectionConfiguration">
<h1 id="data-selection-configuration">Data selection configuration</h1>

<p>In addition to the data source configuration, you need to provide a data selection configuration to specify the data you want the OPC UA EDS adapter to collect from the data sources.</p>
<h2 id="configure-opc-ua-data-selection">Configure OPC UA data selection</h2>
<blockquote><p><strong>Note:</strong> You cannot modify OPC UA data selection configurations manually. You must use the REST endpoints to add or edit the configuration.</p>
</blockquote>
<p>Complete the following to configure OPC UA data selection:</p>
<ol>
<li>Using any text editor, create a file that contains an OPC UA data selection in JSON form.<ul>
<li>For content structure, see <a href="#opc-ua-data-selection-example">OPC UA data selection example</a>.</li>
<li>For a table of all available parameters, see <a href="#parameters-for-opc-ua-data-selection">Parameters for OPC UA data selection</a>.</li>
</ul>
</li>
<li>Save the file as <em>DataSelection.config.json</em>.</li>
<li>Use any <a href="xref:managementTools">tool</a> capable of making HTTP requests to execute a POST command with the contents of that file to the following endpoint: <code>http://localhost:5590/api/v1/configuration/&lt;EDS adapterId&gt;/DataSelection/</code></li>
</ol>
<p>Example using cURL (run this command from the same directory where the file is located):</p>
<pre><code class="lang-bash">curl -v -d &quot;@DataSelection.config.json&quot; -H &quot;Content-Type: application/json&quot; &quot;http://localhost:5590/api/v1/configuration/&lt;EDS adapterId&gt;/DataSelection&quot;
</code></pre><h2 id="opc-ua-data-selection-schema">OPC UA data selection schema</h2>
<p>The following table shows the basic behavior of the <em>OpcUa_DataSelection_schema.json</em> file.</p>
<table>
<thead>
<tr>
<th>Abstract</th>
<th>Extensible</th>
<th>Status</th>
<th>Identifiable</th>
<th>Custom properties</th>
<th>Additional properties</th>
</tr>
</thead>
<tbody>
<tr>
<td>Can be instantiated</td>
<td>Yes</td>
<td>Experimental</td>
<td>No</td>
<td>Forbidden</td>
<td>Forbidden</td>
</tr>
</tbody>
</table>
<h2 id="parameters-for-opc-ua-data-selection">Parameters for OPC UA data selection</h2>
<p>The following parameters can be used to configure OPC UA data selection:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Nullable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Selected</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>No</td>
<td>Use this field to select or clear a measurement. To select an item, set to true. To remove an item, leave the field empty or set to false.  If not configured, the default value is false.</td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Yes</td>
<td>The optional friendly name of the data item collected from the data source. If not configured, the default value will be the stream id.</td>
</tr>
<tr>
<td><strong>NodeId</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>Yes</td>
<td>The NodeId of the variable.</td>
</tr>
<tr>
<td><strong>StreamID</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Yes</td>
<td>The custom stream ID used to create the streams. If not specified, the OPC UA EDS adapter will generate a default stream ID based on the measurement configuration. A properly configured custom stream ID follows these rules:<br><br>Is not case-sensitive.<br>Can contain spaces.<br>Cannot start with two underscores (&quot;__&quot;).<br>Can contain a maximum of 260 characters.<br>Cannot use the following characters: / : ? # [ ] @ ! $ &amp; &#39; ( ) \ * + , ; = % &lt; &gt; &#124;<br>Cannot start or end with a period.<br>Cannot contain consecutive periods.<br>Cannot consist of only periods.</td>
</tr>
</tbody>
</table>
<h2 id="opc-ua-data-selection-example">OPC UA data selection example</h2>
<p>The following is an example of valid OPC UA Data Selection configuration:</p>
<pre><code class="lang-json">[
 {
    &quot;Selected&quot;: true,
    &quot;Name&quot;: &quot;Random1&quot;,
    &quot;NodeId&quot;: &quot;ns=5;s=Random1&quot;,
    &quot;StreamId&quot;: &quot;CustomStreamName&quot;
  },
  {
    &quot;Selected&quot;: false,
    &quot;Name&quot;: &quot;Sawtooth1&quot;,
    &quot;NodeId&quot;: &quot;ns=5;s=Sawtooth1&quot;,
    &quot;StreamId&quot;: null
  },
  {
    &quot;Selected&quot;: true,
    &quot;Name&quot;: &quot;Sinusoid1&quot;,
    &quot;NodeId&quot;: &quot;ns=5;s=Sinusoid1&quot;,
    &quot;StreamId&quot;: null
  }
]
</code></pre><h2 id="generate-template-opc-ua-data-selection-configuration-file">Generate template OPC UA data selection configuration file</h2>
<p>When you add a data source, the OPC UA EDS adapter browses the entire OPC UA server address space and exports the available OPC UA variables into a .json file for data selection. Data is collected automatically based upon user demands. OPC UA data from OPC UA variables is read through subscriptions (unsolicited reads).</p>
<p>A default OPC UA data source template file will be created if there is no OPC UA data selection configuration, but a valid OPC UA data source exists.</p>
<p>Complete the following steps in order for this template data selection to be generated:</p>
<ol>
<li><p>Add an <a class="xref" href="../Configuration/EdgeSystemConfiguration.html">OPC UA EDS adapter</a> with a unique ComponentId. </p>
<p>During the installation of Edge Data Store, enabling the OPC UA adapter results in addition of a unique component that also satisfies this condition.</p>
</li>
<li><p>Configure a valid <a class="xref" href="OpcUaOverview.html">OPC UA Data Source</a>.</p>
<p>Once you complete these steps, a template OPC UA data selection will be generated in the Configuration directory for the corresponding platform. Also see <a class="xref" href="../LinuxWindows/LinuxWindows.html">Linux and Windows platform differences</a>. The following are example locations of the file created. In this example, it is assumed that the ComponentId of the OPC UA component is the default OpcUa1:</p>
<pre><code class="lang-bash">Windows: %programdata%\OSIsoft\EdgeDataStore\Configuration\OpcUa1_DataSelection.json

Linux: /usr/share/OSIsoft/EdgeDataStore/Configuration/OpcUa1_DataSelection.json
</code></pre></li>
<li><p>Copy the file to a different directory to edit it. </p>
<p>The contents of the file will look something like:</p>
<pre><code class="lang-json">[
{
  &quot;Selected&quot;: false,
  &quot;Name&quot;: &quot;Cold Side Inlet Temperature&quot;,
  &quot;NodeId&quot;: &quot;ns=2;s=Line1.HeatExchanger1001.ColdSideInletTemperature&quot;,
  &quot;StreamId&quot;: null
 },
 {
  &quot;Selected&quot;: false,
  &quot;Name&quot;: &quot;Cold Side Outlet Temperature&quot;,
  &quot;NodeId&quot;: &quot;ns=2;s=Line1.HeatExchanger1001.ColdSideOutletTemperature&quot;,
  &quot;StreamId&quot;: null
 }
]
</code></pre></li>
<li><p>In a text editor, edit the file and change the value of any Selected key from false to true in order to transfer the OPC UA data to be stored in Edge Data Store. </p>
</li>
<li><p>In the same directory where you edited the file, run the following curl command:</p>
<pre><code class="lang-bash">curl -i -d &quot;@OpcUa1_DataSelection.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT http://localhost:5590/api/v1/configuration/OpcUa1/Dataselection
</code></pre></li>
</ol>
<p>To see the streams that have been created in Edge Storage to store the data you are writing, run the following curl script:</p>
<pre><code class="lang-bash">curl http://localhost:5590/api/v1/tenants/default/namespaces/default/streams/
</code></pre><p>To view the data in the streams being written, refer to <a class="xref" href="../SDS/SequentialDataStore.html">Sequential Data Store (SDS)</a>.</p>
<p>To egress the data to OSIsoft Cloud Services or the PI System, see <a class="xref" href="../Egress/Egress.html">Data egress configuration</a>.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/Edge-Data-Store-Docs/blob/master/V1/OpcUa/OPCUADataSelectionConfiguration.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
            <span id='copyright-text'>© 2019 - OSIsoft, LLC.<span>
        </span></span></div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
